<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="icia.escape.db.AuthenticationMapper">

  <select id="isMember" parameterType="icia.escape.beans.Members" resultType="icia.escape.beans.Members">
      SELECT MM_PASSWORD AS MMPASSWORD, MM_CODE AS MMCODE FROM MM WHERE MM_ID=#{mmId}
   </select>
   
   <select id="isAccess" parameterType="icia.escape.beans.Members" resultType="int">
      SELECT COUNT(*) FROM MM WHERE MM_CODE=#{mmCode} AND MM_ID=#{mmId} AND MM_PASSWORD=#{mmPassword}
   </select>
   
   <insert id="insMembersAccessHistory" parameterType="icia.escape.beans.Members">
      INSERT INTO AH(AH_ACCESSTIME, AH_MMCODE, AH_STCODE, AH_IP) 
      VALUES(DEFAULT, #{mmCode},#{stCode},#{publicIp})
   </insert>

  <select id="getMemberAccessInfo" parameterType = "icia.escape.beans.Members" resultType = "icia.escape.beans.Members">
      
    </select>
	
	<select id="isStores" parameterType="icia.escape.beans.Stores" resultType="icia.escape.beans.Stores">
      SELECT SR_PASSWORD AS SRPASSWORD, SR_CODE AS SRCODE FROM SR WHERE SR_ID=#{srId}
   </select>
   
   <select id="isStoresAccess" parameterType="icia.escape.beans.Stores" resultType="int">
      SELECT COUNT(*) FROM SR WHERE SR_CODE=#{srCode} AND SR_ID=#{srId} AND SR_PASSWORD=#{srPassword}
   </select>
   
   <insert id="insStoresAccessHistory" parameterType="icia.escape.beans.Stores">
      INSERT INTO AH(AH_ACCESSTIME, AH_MMCODE, AH_STCODE, AH_IP) 
      VALUES(DEFAULT, #{srCode},#{stCode},#{publicIp})
   </insert>
</mapper>